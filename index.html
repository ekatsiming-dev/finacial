<!DOCTYPE html>
<html lang="zh-TW">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Financial Fortress V2.9 - Strategic Roadmap Edition</title>
    
    <!-- Tailwind CSS -->
    <script src="https://cdn.tailwindcss.com"></script>
    
    <!-- Chart.js -->
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>

    <!-- Lucide Icons -->
    <script src="https://unpkg.com/lucide@latest"></script>

    <!-- Google Fonts -->
    <link href="https://fonts.googleapis.com/css2?family=Noto+Sans+TC:wght@400;700;900&family=Share+Tech+Mono&display=swap" rel="stylesheet">

    <style>
        body {
            font-family: 'Noto Sans TC', sans-serif;
            background-color: #f4f1ea;
            color: #18181b;
            overflow-x: hidden;
        }
        
        .font-mono-retro {
            font-family: 'Share Tech Mono', monospace;
        }

        /* Custom Scrollbar */
        ::-webkit-scrollbar {
            width: 10px;
        }
        ::-webkit-scrollbar-track {
            background: #f4f1ea; 
        }
        ::-webkit-scrollbar-thumb {
            background: #18181b; 
            border: 2px solid #f4f1ea;
            border-radius: 5px;
        }

        /* Animation utilities */
        .fade-in {
            animation: fadeIn 0.3s ease-in-out;
        }
        @keyframes fadeIn {
            from { opacity: 0; transform: scale(0.95); }
            to { opacity: 1; transform: scale(1); }
        }
        
        /* CRT Scanline Effect */
        .scanlines {
            background: linear-gradient(
                to bottom,
                rgba(255,255,255,0),
                rgba(255,255,255,0) 50%,
                rgba(0,0,0,0.2) 50%,
                rgba(0,0,0,0.2)
            );
            background-size: 100% 4px;
            animation: scanline 10s linear infinite;
        }
        
        /* Typing Cursor Blink */
        .cursor-blink {
            animation: blink 1s step-end infinite;
        }
        @keyframes blink {
            0%, 100% { opacity: 1; }
            50% { opacity: 0; }
        }

        /* Pop Art Colors Helper Classes */
        .bg-pop-blue { background-color: #3b82f6; }
        .bg-pop-red { background-color: #ff6b6b; }
        .bg-pop-yellow { background-color: #fbbf24; }
        .bg-pop-orange { background-color: #fb923c; }
        .bg-pop-green { background-color: #34d399; }
        .bg-pop-purple { background-color: #a78bfa; }
    </style>
</head>
<body class="selection:bg-[#ff6b6b] selection:text-white pb-12">

    <!-- Texture Overlay (Grain) -->
    <div class="fixed inset-0 opacity-[0.04] pointer-events-none z-50 mix-blend-multiply" 
         style="background-image: url('data:image/svg+xml,%3Csvg viewBox=\'0 0 200 200\' xmlns=\'http://www.w3.org/2000/svg\'%3E%3Cfilter id=\'noiseFilter\'%3E%3CfeTurbulence type=\'fractalNoise\' baseFrequency=\'0.65\' numOctaves=\'3\' stitchTiles=\'stitch\'/%3E%3C/filter%3E%3Crect width=\'100%25\' height=\'100%25\' filter=\'url(%23noiseFilter)\'/%3E%3C/svg%3E')">
    </div>

    <!-- Header Section -->
    <div class="border-b-4 border-black bg-white sticky top-0 z-40">
        <div class="max-w-7xl mx-auto px-4 py-4 flex flex-col md:flex-row justify-between items-center gap-4">
            <div class="flex items-center gap-4 group cursor-pointer">
                <div class="w-12 h-12 bg-[#ff6b6b] border-2 border-black shadow-[4px_4px_0px_0px_rgba(0,0,0,1)] flex items-center justify-center transform group-hover:-rotate-12 transition-transform duration-300">
                    <i data-lucide="shield" class="w-7 h-7 text-white"></i>
                </div>
                <div>
                    <h1 class="text-3xl font-black tracking-tight uppercase italic text-black group-hover:text-[#ff6b6b] transition-colors">
                        MY FORTRESS
                    </h1>
                    <p class="font-bold text-sm text-gray-500">è³‡ç”¢å®ˆè­·æ—¥èªŒ Vol.2.9</p>
                </div>
            </div>
            
            <div class="bg-[#18181b] text-white px-6 py-2 border-2 border-black shadow-[4px_4px_0px_0px_#ff6b6b] font-bold text-lg rounded-full flex items-center gap-2 transform hover:scale-105 transition-transform">
                <i data-lucide="layout-grid" class="w-4 h-4 text-[#ff6b6b]"></i>
                <span id="total-assets-display">Total: NT$ ...</span>
            </div>
        </div>
    </div>

    <div class="max-w-7xl mx-auto px-4 mt-12 space-y-12 relative z-10">

        <!-- Hero Section: Chart & Key Metrics -->
        <div class="grid grid-cols-1 lg:grid-cols-12 gap-8">
            
            <!-- Main Chart Card -->
            <div class="lg:col-span-7 bg-white border-4 border-black shadow-[8px_8px_0px_0px_rgba(0,0,0,1)] p-8 relative rounded-xl overflow-hidden min-h-[400px]">
                <!-- Decorative Background Pattern -->
                <div class="absolute top-0 right-0 w-32 h-32 opacity-10" 
                     style="background-image: radial-gradient(#000 2px, transparent 2px); background-size: 10px 10px;"></div>
                
                <div class="flex justify-between items-start mb-6 relative z-10">
                    <h2 class="text-2xl font-black flex items-center gap-2">
                        <span class="bg-black text-white px-2 py-1 transform -rotate-2 inline-block shadow-sm">01</span>
                        é‡‘èè³‡ç”¢ç‰ˆåœ–
                    </h2>
                    <div class="text-xs font-bold text-gray-400 flex items-center gap-1 border border-gray-200 px-2 py-1 rounded-full bg-gray-50">
                        <i data-lucide="mouse-pointer-2" class="w-3 h-3"></i>
                        HOVER SECTORS
                    </div>
                </div>

                <div class="flex flex-col md:flex-row items-center gap-12 relative z-10">
                    <!-- Pie Chart Area with Dynamic Center -->
                    <div class="w-72 h-72 relative flex-shrink-0 mx-auto md:mx-0">
                        <canvas id="assetChart"></canvas>
                        
                        <!-- Dynamic Center HUD -->
                        <div id="chart-hud" class="absolute inset-0 flex flex-col items-center justify-center pointer-events-none transition-all duration-200">
                            <!-- Default State -->
                            <div id="hud-default" class="bg-[#f4f1ea] p-4 rounded-full border-2 border-black/10">
                                <i data-lucide="shield" class="w-8 h-8 text-black/20"></i>
                            </div>
                            <!-- Active State (Hidden by default) -->
                            <div id="hud-active" class="text-center hidden">
                                <div id="hud-color-dot" class="w-2 h-2 rounded-full mb-1 mx-auto bg-black"></div>
                                <span class="text-xs font-bold text-gray-400 block mb-0.5 tracking-wider uppercase">Current</span>
                                <span id="hud-name" class="text-sm font-black text-black block leading-tight px-2">Name</span>
                                <span id="hud-value" class="text-2xl font-black font-mono mt-1 block">Value</span>
                            </div>
                        </div>
                    </div>

                    <!-- Stats Cards (Offensive/Defensive) -->
                    <div class="flex-1 w-full space-y-4">
                        <!-- Offensive Stats -->
                        <div id="stat-offensive" class="p-4 border-2 border-black shadow-[4px_4px_0px_0px_#3b82f6] rounded-lg transition-all duration-300 relative overflow-hidden bg-[#eff6ff]">
                            <div class="flex justify-between items-center mb-2 relative z-10">
                                <span class="font-black text-lg flex items-center gap-2 text-[#1e40af]" id="stat-offensive-label">
                                    <i data-lucide="zap" class="w-5 h-5 fill-current"></i> æ”»æ“Šéƒ¨éšŠ
                                </span>
                                <span class="font-bold px-2 border border-black rounded-md text-sm bg-white text-black" id="stat-offensive-pct">
                                    --%
                                </span>
                            </div>
                            <div class="text-3xl font-black relative z-10 tracking-tight text-[#1e3a8a]" id="stat-offensive-val">
                                $ --
                            </div>
                        </div>

                        <!-- Defensive Stats -->
                        <div id="stat-defensive" class="p-4 border-2 border-black shadow-[4px_4px_0px_0px_#34d399] rounded-lg transition-all duration-300 relative overflow-hidden bg-[#ecfdf5]">
                            <div class="flex justify-between items-center mb-2 relative z-10">
                                <span class="font-black text-lg flex items-center gap-2 text-[#065f46]" id="stat-defensive-label">
                                    <i data-lucide="shield" class="w-5 h-5 fill-current"></i> ç¾é‡‘é˜²ç·š
                                </span>
                                <span class="font-bold px-2 border border-black rounded-md text-sm bg-white text-black" id="stat-defensive-pct">
                                    --%
                                </span>
                            </div>
                            <div class="text-3xl font-black relative z-10 tracking-tight text-[#064e3b]" id="stat-defensive-val">
                                $ --
                            </div>
                        </div>
                    </div>
                </div>
            </div>

            <!-- Real Estate "Postcard" (Updated Value & Details) -->
            <div class="lg:col-span-5 flex flex-col">
                <div class="bg-[#ff6b6b] text-white border-4 border-black shadow-[8px_8px_0px_0px_rgba(0,0,0,1)] p-6 rounded-xl flex-1 relative overflow-hidden group">
                    <!-- Pattern -->
                    <div class="absolute inset-0 opacity-20" 
                         style="background-image: repeating-linear-gradient(45deg, transparent, transparent 10px, #000 10px, #000 11px);"></div>
                    
                    <div class="relative z-10 h-full flex flex-col justify-between">
                        <div>
                            <div class="flex justify-between items-start">
                                <div class="bg-white text-black border-2 border-black px-3 py-1 font-black text-sm uppercase transform -rotate-3 inline-block shadow-sm">
                                    FORTRESS
                                </div>
                                <i data-lucide="home" class="w-10 h-10 text-white stroke-[2.5]"></i>
                            </div>
                            
                            <h2 class="text-4xl font-black mt-6 leading-tight drop-shadow-[2px_2px_0px_rgba(0,0,0,0.5)]">
                                å°å—<br/>æ ¸å¿ƒå ¡å£˜
                            </h2>
                            <p class="font-bold mt-2 opacity-100 text-black bg-white/90 inline-block px-2 transform rotate-1 border border-black">
                                30å¹´å¤§æ¨“ / å¸‚å€¼ç´„ 630è¬
                            </p>
                        </div>

                        <div class="mt-8 bg-black/20 backdrop-blur-sm p-4 border-2 border-black/10 rounded-lg group-hover:bg-black/30 transition-colors">
                            <div class="flex items-center gap-3 mb-2">
                                <div class="bg-[#34d399] text-black p-1 rounded-full border border-black">
                                    <i data-lucide="check-circle-2" class="w-4 h-4 text-black"></i>
                                </div>
                                <span class="font-bold text-white shadow-black drop-shadow-md">2017å¹´ç®¡è·¯å·²ç¶­ä¿®</span>
                            </div>
                            <p class="text-sm font-bold text-white/90 italic border-l-2 border-white pl-2">
                                "æ–°é’å®‰ 40å¹´ç¥ç´šåˆç´„ï¼Œç©©å¥å¢å€¼ä¸­ã€‚"
                            </p>
                        </div>
                    </div>
                </div>
            </div>
        </div>

        <!-- Asset Cards Grid -->
        <div>
            <h3 class="text-2xl font-black mb-6 flex items-center gap-3">
                <span class="w-4 h-4 bg-black rounded-sm transform rotate-45 shrink-0"></span>
                <span class="whitespace-nowrap">è³‡ç”¢æ˜ç´°å¡</span>
                <span class="flex-1 h-1 bg-black rounded-full ml-4 opacity-10 border-b-2 border-dashed border-black/20 h-0"></span>
            </h3>

            <!-- Dynamic Grid Container -->
            <div id="asset-cards-container" class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6">
                <!-- Cards will be injected here by JS -->
            </div>
        </div>

        <!-- Wealth Guardian AI Terminal v2.0 -->
        <div class="bg-[#18181b] p-6 rounded-xl border-4 border-black shadow-[8px_8px_0px_0px_#a78bfa] relative overflow-hidden group">
            <!-- Scanline Overlay -->
            <div class="scanlines absolute inset-0 pointer-events-none opacity-20"></div>
            
            <div class="flex flex-col md:flex-row gap-8 relative z-10">
                <!-- Left: Guardian Core -->
                <div class="flex-shrink-0 flex flex-col justify-center items-center md:items-start min-w-[200px] border-b md:border-b-0 md:border-r border-gray-800 pb-4 md:pb-0 md:pr-8">
                    <div class="flex items-center gap-2 mb-2">
                         <i data-lucide="bot" class="w-5 h-5 text-[#34d399] animate-pulse"></i>
                         <span class="text-[#34d399] font-mono-retro tracking-widest text-xs">GUARDIAN_v2.0</span>
                    </div>
                    <div class="text-4xl md:text-5xl font-black text-white font-mono-retro tracking-tighter" id="ai-status">COAST FIRE</div>
                    <div class="text-gray-500 text-xs font-bold mt-1 uppercase tracking-widest">Protocol Active</div>
                    <!-- Health Bar -->
                    <div class="w-full h-2 bg-gray-800 mt-4 rounded-full overflow-hidden border border-gray-700">
                        <div class="h-full bg-[#3b82f6] shadow-[0_0_10px_#3b82f6]" style="width: 100%"></div>
                    </div>
                </div>

                <!-- Right: Empowering Message -->
                <div class="flex-grow font-mono-retro text-sm md:text-base space-y-3 pt-2">
                    <p class="text-green-400">> èº«ä»½ç¢ºèªï¼šéšç´šç¿»è½‰è¦‹è­‰è€…ã€‚æ­¡è¿å›ä¾†ã€‚</p>
                    <p class="text-gray-300">> <span class="text-white font-bold bg-gray-800 px-1">å®‰å¿ƒæ¿¾ç¶²:</span> ç¾é‡‘é˜²ç·šå……è¶³ (éƒµå±€+Richart+è–ªè½‰)ã€‚ç¡çœ å“è³ªæª¢æ¸¬ï¼š<span class="text-[#34d399]">PASS</span>ã€‚</p>
                    <p class="text-gray-300">> <span class="text-white font-bold bg-gray-800 px-1">éš±è—è³‡ç”¢:</span> åµæ¸¬åˆ°ã€Œåœ‹å®¶ç´šè­·ç›¾ã€(å‹ä¿å‹é€€)ã€‚é€™æ˜¯æ”¿åºœç™¼çµ¦ä½ çš„é•·å£½è–ªæ°´ï¼Œçµ‚èº«æœ‰æ•ˆã€‚</p>
                    <p class="text-[#a78bfa] font-bold mt-2 flex items-center gap-2">
                        <i data-lucide="terminal" class="w-4 h-4"></i>
                        æ•™ç·´æŒ‡ä»¤ï¼šä½ çš„ 2056 å¹´åŠ‡æœ¬å·²å¯«å¥½ï¼Œç¾åœ¨ç…§è‘—æ¼”å°±è¡Œã€‚
                        <span class="cursor-blink inline-block w-2 h-4 bg-[#a78bfa] align-middle ml-1"></span>
                    </p>
                </div>
            </div>
        </div>
        
        <!-- Endgame Projection Section (Net Worth Stack) -->
        <div class="bg-white border-4 border-black shadow-[8px_8px_0px_0px_#a78bfa] p-6 rounded-xl mt-8 relative overflow-hidden">
            <!-- Background Icon -->
            <div class="absolute top-0 right-0 p-4 opacity-10">
                <i data-lucide="mountain-snow" class="w-32 h-32 text-[#a78bfa]"></i>
            </div>
            
            <div class="relative z-10">
                <h3 class="text-2xl font-black flex items-center gap-3 mb-6">
                    <i data-lucide="flag" class="w-8 h-8 text-[#a78bfa] fill-current"></i>
                    65æ­² çµ‚å±€é æ¼” (The Final Projection)
                </h3>
                
                <!-- Goals Visualizer -->
                <div class="space-y-6">
                    <!-- Projection Bar -->
                    <div>
                        <div class="flex justify-between items-end mb-2">
                            <span class="text-sm font-bold text-gray-500">é ä¼°èº«åƒ¹å †ç–Š (æˆ¿ç”¢+é‡‘è+åœ‹å®¶)</span>
                            <span class="text-3xl font-black text-black">~ 2,550 è¬</span>
                        </div>
                        <div class="w-full h-10 bg-gray-100 border-2 border-black rounded-lg overflow-hidden flex">
                            <!-- Property -->
                            <div class="h-full bg-[#ff6b6b] flex items-center justify-center text-xs font-bold text-white border-r border-black relative group" style="width: 45%">
                                ğŸ  æˆ¿ç”¢ 1150W
                                <div class="absolute inset-0 bg-white opacity-0 group-hover:opacity-10 transition-opacity"></div>
                            </div>
                            <!-- Financial -->
                            <div class="h-full bg-[#3b82f6] flex items-center justify-center text-xs font-bold text-white border-r border-black relative group" style="width: 31%">
                                ğŸ’° é‡‘è 800W
                            </div>
                            <!-- Gov -->
                            <div class="h-full bg-[#34d399] flex items-center justify-center text-xs font-bold text-white relative group" style="width: 24%">
                                ğŸ›ï¸ åœ‹å®¶ 600W
                            </div>
                        </div>
                    </div>

                    <!-- Milestones -->
                    <div class="grid grid-cols-2 gap-4">
                        <!-- Goal 1 -->
                        <div class="p-3 border-2 border-black rounded-lg bg-[#f4f1ea] opacity-50">
                            <div class="flex items-center gap-2 mb-1">
                                <div class="w-3 h-3 rounded-full bg-green-500"></div>
                                <span class="text-xs font-bold uppercase">Target A: å±…å®¶å®‰è€</span>
                            </div>
                            <div class="text-xl font-black">2,100 è¬</div>
                            <div class="text-xs font-bold text-green-600 mt-1">å·²é”æˆ (PASS)</div>
                        </div>
                        <!-- Goal 2 -->
                        <div class="p-3 border-2 border-black rounded-lg bg-white relative overflow-hidden">
                            <div class="absolute top-0 right-0 w-8 h-8 bg-yellow-400 transform rotate-45 translate-x-4 -translate-y-4"></div>
                            <div class="flex items-center gap-2 mb-1">
                                <div class="w-3 h-3 rounded-full bg-yellow-500 animate-pulse"></div>
                                <span class="text-xs font-bold uppercase">Target B: é«˜ç´šè€äººæ‘</span>
                            </div>
                            <div class="text-xl font-black">3,400 è¬</div>
                            <div class="text-xs font-bold text-gray-500 mt-1">ç¼ºå£: æˆ¿å­ (é—œéµè®Šæ•¸)</div>
                        </div>
                    </div>
                </div>
            </div>
        </div>

        <!-- Strategic Roadmap Section (Sorted: Near -> Far) -->
        <div class="bg-[#fbbf24] border-4 border-black shadow-[8px_8px_0px_0px_rgba(0,0,0,1)] p-6 rounded-xl mt-8 mb-8 relative group">
            <!-- Attention Badge -->
            <div class="absolute -top-4 -left-4 bg-black text-[#fbbf24] px-4 py-2 font-black border-2 border-[#fbbf24] transform rotate-3 shadow-lg group-hover:rotate-6 transition-transform">
                STRATEGIC ROADMAP
            </div>
            
            <div class="flex flex-col md:flex-row gap-8 items-center mt-2">
                <div class="flex-1">
                    <h3 class="text-2xl font-black flex items-center gap-3">
                        <i data-lucide="alert-triangle" class="w-8 h-8 fill-black text-[#fbbf24]"></i>
                        è¿‘æœŸæŒ‘æˆ° (2029)
                    </h3>
                    <div class="mt-4 bg-white border-2 border-black p-4 rounded-lg shadow-[4px_4px_0px_0px_rgba(0,0,0,0.2)]">
                        <div class="flex items-end gap-2">
                            <span class="text-5xl font-black tabular-nums text-black" id="countdown-days">--</span>
                            <span class="font-bold text-gray-500 mb-2">DAYS LEFT</span>
                        </div>
                        <!-- Retro Progress Bar -->
                        <div class="w-full h-4 bg-gray-200 border-2 border-black rounded-full mt-2 overflow-hidden relative">
                            <div class="h-full bg-black absolute top-0 left-0" style="width: 40%"></div>
                            <!-- Striped pattern overlay -->
                            <div class="absolute inset-0 w-full h-full opacity-20" style="background-image: repeating-linear-gradient(45deg, transparent, transparent 5px, #fff 5px, #fff 10px);"></div>
                        </div>
                        <div class="mt-2 text-xs font-bold text-gray-500">ç›®æ¨™ï¼šå¯¬é™æœŸçµæŸï¼Œç¾é‡‘æµä¸å´©æ½°ã€‚</div>
                    </div>
                </div>

                <div class="flex-1 bg-white/80 border-2 border-black border-dashed p-5 rounded-lg transform rotate-1">
                    <div class="flex items-center gap-2 mb-3 font-bold text-lg border-b-2 border-black pb-1">
                        <i data-lucide="map" class="w-5 h-5 text-[#ff6b6b] fill-current"></i>
                        <span>ç›®æ¨™æ™‚åº (è¿‘ -> é )</span>
                    </div>
                    <ul class="space-y-3 font-bold text-gray-800 text-sm md:text-base">
                        <li class="flex items-start gap-2">
                            <span class="bg-black text-[#fbbf24] px-1.5 rounded-sm shrink-0 text-xs mt-0.5">è¿‘ç¨‹ 2029</span>
                            <span><strong>å¯¬é™æœŸå°ç­–</strong>ï¼šæˆ¿è²¸æœˆä»˜å€å¢ã€‚å„ªå…ˆæš«åœå°è‚¡æŠ•å…¥ï¼Œä¸å‹•æˆ¿ç”¢ï¼Œä¸è§£å®šå­˜ã€‚</span>
                        </li>
                        <li class="flex items-start gap-2">
                            <span class="bg-[#3b82f6] text-white px-1.5 rounded-sm shrink-0 text-xs mt-0.5">ä¸­ç¨‹ 50æ­²</span>
                            <span><strong>Coast FIRE å•Ÿå‹•</strong>ï¼šç¾è‚¡ DRIP è½‰ç‚ºæé ˜æ¨¡å¼ (4%)ï¼Œè£œè²¼ç”Ÿæ´»ï¼Œå·¥ä½œè®Šèˆˆè¶£ã€‚</span>
                        </li>
                        <li class="flex items-start gap-2">
                            <span class="bg-[#a78bfa] text-white px-1.5 rounded-sm shrink-0 text-xs mt-0.5">é ç¨‹ 65æ­²</span>
                            <span><strong>çµ‚å±€äºŒé¸ä¸€</strong>ï¼šè³‡ç”¢æ¸…ç®—ã€‚é¸æ“‡å±…å®¶å®‰è€ (å·²é”æ¨™) æˆ– è®Šè³£æˆ¿ç”¢å‡ç´šè€äººæ‘ã€‚</span>
                        </li>
                    </ul>
                </div>
            </div>
        </div>

        <!-- Footer -->
        <div class="text-center font-bold text-gray-400 py-8 flex items-center justify-center gap-2 border-t-2 border-black/10">
            <i data-lucide="coffee" class="w-4 h-4"></i>
            <span>DESIGNED FOR PEACE OF MIND</span>
        </div>

    </div>

    <!-- MAIN SCRIPT -->
    <script>
        // --- 1. CONFIG & DATA ---
        const POP_COLORS = {
            blue: '#3b82f6',   // Electric Blue
            red: '#ff6b6b',    // Coral Red
            yellow: '#fbbf24', // Sunshine Yellow
            orange: '#fb923c', // Pop Orange
            green: '#34d399',  // Mint Green
            purple: '#a78bfa', // Grape Purple
            black: '#18181b',  // Ink Black
            bg: '#f4f1ea',     // Paper
            offensive: '#eff6ff', // Light Blue bg
            defensive: '#ecfdf5'  // Light Green bg
        };

        const GOAL_TARGET = 21000000; // 21 Million Target

        // Updated Assets based on Wealth Guardian Persona
        const assets = [
            { name: 'ç¾åœ‹çˆ¸çˆ¸ (DRIP)', value: 1200000, color: POP_COLORS.blue, type: 'é€²æ”»', icon: 'trending-up', sub: 'Coast FIRE ä¸»åŠ›', subClass: 'text-[#1d4ed8] bg-[#eff6ff] border-[#3b82f6]' },
            { name: 'å°ç£å°šå‹‡ (å®šæœŸ)', value: 190000, color: POP_COLORS.red, type: 'é€²æ”»', icon: 'award', sub: '2029 æˆ°ç•¥å„²å‚™', subClass: 'text-[#b91c1c] bg-[#fef2f2] border-[#ff6b6b]' },
            { name: 'å°ç‹—ç‹— (èˆŠæŠ•)', value: 80000, color: POP_COLORS.orange, type: 'é€²æ”»', icon: 'heart-handshake', sub: 'æˆ°ç•¥æŒè‚¡ (å‹³ç« )', subClass: 'text-[#9a3412] bg-[#ffedd5] border-[#fb923c]' },
            { name: 'å°ç‹—ç‹— (ç”Ÿæ´»)', value: 375000, color: POP_COLORS.yellow, type: 'é˜²ç¦¦', icon: 'piggy-bank', sub: 'Richart / å®šå­˜ / å¤–åŒ¯', subClass: 'text-[#713f12] bg-[#fef3c7] border-[#facc15]' },
            { name: 'éƒµå±€èšå¯¶ç›†', value: 160000, color: POP_COLORS.green, type: 'é˜²ç¦¦', icon: 'lock', sub: 'æœ€å¾Œé˜²ç·š (å®šå­˜)', subClass: 'text-[#047857] bg-[#ecfdf5] border-[#34d399]' },
            { name: 'é£½é£½çš„å°éŠ€ (è–ªè½‰)', value: 50000, color: POP_COLORS.purple, type: 'é˜²ç¦¦', icon: 'wallet', sub: 'è–ªè½‰æµå‹•ç¾é‡‘', subClass: 'text-[#6d28d9] bg-[#f3e8ff] border-[#a78bfa]' }
        ];

        // --- 2. CALCULATIONS ---
        const totalAssets = assets.reduce((acc, curr) => acc + curr.value, 0);
        const defensiveAssets = assets.filter(a => a.type === 'é˜²ç¦¦').reduce((acc, curr) => acc + curr.value, 0);
        const offensiveAssets = assets.filter(a => a.type === 'é€²æ”»').reduce((acc, curr) => acc + curr.value, 0);

        const today = new Date();
        const deadline = new Date('2029-07-01');
        const diffTime = Math.abs(deadline - today);
        const diffDays = Math.ceil(diffTime / (1000 * 60 * 60 * 24));

        // Format Currency
        const fmt = (n) => n.toLocaleString();
        const fmtWan = (n) => (n/10000).toFixed(1) + 'è¬';

        // --- 3. DOM INJECTION ---
        
        // Header Total
        document.getElementById('total-assets-display').textContent = `Total: NT$ ${fmt(totalAssets)}`;
        
        // Countdown
        document.getElementById('countdown-days').textContent = diffDays;

        // Stats Panels (Initial Static Values)
        const updateStats = (activeType = null) => {
            const offEl = document.getElementById('stat-offensive');
            const defEl = document.getElementById('stat-defensive');
            
            // Labels
            const offLabel = document.getElementById('stat-offensive-label');
            const defLabel = document.getElementById('stat-defensive-label');
            const offPct = document.getElementById('stat-offensive-pct');
            const defPct = document.getElementById('stat-defensive-pct');
            const offVal = document.getElementById('stat-offensive-val');
            const defVal = document.getElementById('stat-defensive-val');

            // Set Values
            offPct.textContent = ((offensiveAssets/totalAssets)*100).toFixed(0) + '%';
            defPct.textContent = ((defensiveAssets/totalAssets)*100).toFixed(0) + '%';
            offVal.textContent = '$ ' + fmt(offensiveAssets);
            defVal.textContent = '$ ' + fmt(defensiveAssets);

            // Active State Styling (Highlighting)
            if (activeType === 'é€²æ”»') {
                offEl.className = `p-4 border-2 border-black shadow-[4px_4px_0px_0px_#3b82f6] rounded-lg transition-all duration-300 relative overflow-hidden bg-[#3b82f6] text-white ring-2 ring-offset-2 ring-[#3b82f6]`;
                offLabel.className = `font-black text-lg flex items-center gap-2 text-white`;
                offPct.className = `font-bold px-2 border border-black rounded-md text-sm bg-white text-[#3b82f6]`;
                offVal.className = `text-3xl font-black relative z-10 tracking-tight text-white`;
            } else {
                offEl.className = `p-4 border-2 border-black shadow-[4px_4px_0px_0px_#3b82f6] rounded-lg transition-all duration-300 relative overflow-hidden bg-[#eff6ff]`;
                offLabel.className = `font-black text-lg flex items-center gap-2 text-[#1e40af]`;
                offPct.className = `font-bold px-2 border border-black rounded-md text-sm bg-white text-black`;
                offVal.className = `text-3xl font-black relative z-10 tracking-tight text-[#1e3a8a]`;
            }

            if (activeType === 'é˜²ç¦¦') {
                defEl.className = `p-4 border-2 border-black shadow-[4px_4px_0px_0px_#34d399] rounded-lg transition-all duration-300 relative overflow-hidden bg-[#34d399] text-white ring-2 ring-offset-2 ring-[#34d399]`;
                defLabel.className = `font-black text-lg flex items-center gap-2 text-white`;
                defPct.className = `font-bold px-2 border border-black rounded-md text-sm bg-white text-[#34d399]`;
                defVal.className = `text-3xl font-black relative z-10 tracking-tight text-white`;
            } else {
                defEl.className = `p-4 border-2 border-black shadow-[4px_4px_0px_0px_#34d399] rounded-lg transition-all duration-300 relative overflow-hidden bg-[#ecfdf5]`;
                defLabel.className = `font-black text-lg flex items-center gap-2 text-[#065f46]`;
                defPct.className = `font-bold px-2 border border-black rounded-md text-sm bg-white text-black`;
                defVal.className = `text-3xl font-black relative z-10 tracking-tight text-[#064e3b]`;
            }
        };

        updateStats(); // Init

        // Generate Cards
        const cardContainer = document.getElementById('asset-cards-container');
        assets.forEach((asset, index) => {
            const card = document.createElement('div');
            // Hover logic added via standard class manipulation in CSS/Tailwind usually, but for interaction syncing with chart, we use ID
            card.id = `card-${index}`;
            card.className = `bg-white border-2 border-black p-5 rounded-lg transition-all duration-300 cursor-pointer group hover:-translate-y-2 shadow-[4px_4px_0px_0px_${asset.color}]`;
            
            // Special styling for Dog Bank
            if(asset.name.includes('å°ç‹—ç‹—')) {
                card.classList.add('relative', 'overflow-hidden', 'bg-[#fffbeb]');
                // Add decoration
                const deco = document.createElement('div');
                deco.className = "absolute -top-6 -right-6 w-20 h-20 bg-[#fbbf24] rounded-full opacity-20 border border-black";
                card.appendChild(deco);
            }

            // HTML Content
            card.innerHTML += `
                <div class="flex justify-between items-center mb-4 border-b-2 border-black/10 pb-2 relative z-10">
                    <span class="font-black text-lg transition-colors group-hover:text-[${asset.color}]">${asset.name.split(' ')[0]}</span>
                    <div class="p-1 border border-black rounded-md" style="background-color: ${asset.color}">
                        <i data-lucide="${asset.icon}" class="w-4 h-4 text-white"></i>
                    </div>
                </div>
                <div class="text-3xl font-black text-black mb-2 relative z-10">${asset.value > 100000 ? '> ' : '~'}${asset.value > 1000000 ? (asset.value/10000).toFixed(0) : (asset.value/10000).toFixed(0)}è¬</div>
                <div class="inline-block text-xs font-bold px-2 py-1 border rounded-md relative z-10 ${asset.subClass}">
                   ${asset.sub}
                </div>
            `;
            
            // Add Mouse Events for syncing
            card.addEventListener('mouseenter', () => highlightAsset(index));
            card.addEventListener('mouseleave', () => resetAsset());

            cardContainer.appendChild(card);
        });

        // --- 4. CHART.JS SETUP ---
        const ctx = document.getElementById('assetChart').getContext('2d');
        
        // Prepare Data
        const chartData = {
            labels: assets.map(a => a.name),
            datasets: [{
                data: assets.map(a => a.value),
                backgroundColor: assets.map(a => a.color),
                borderColor: '#18181b', // Black border
                borderWidth: 2,
                hoverOffset: 4,
                hoverBorderWidth: 3
            }]
        };

        // Chart Config
        const assetChart = new Chart(ctx, {
            type: 'doughnut',
            data: chartData,
            options: {
                cutout: '65%', // Create the donut hole
                responsive: true,
                maintainAspectRatio: false,
                plugins: {
                    legend: { display: false }, // Hide default legend
                    tooltip: { enabled: false } // Disable default tooltip (we use HUD)
                },
                onHover: (event, elements) => {
                    if (elements && elements.length > 0) {
                        const index = elements[0].index;
                        highlightAsset(index);
                    } else {
                        resetAsset();
                    }
                }
            }
        });

        // --- 5. INTERACTION LOGIC (HUD & SYNC) ---
        
        function highlightAsset(index) {
            const asset = assets[index];
            
            // 1. Update HUD
            document.getElementById('hud-default').classList.add('hidden');
            const activeHud = document.getElementById('hud-active');
            activeHud.classList.remove('hidden');
            activeHud.classList.add('fade-in');
            
            document.getElementById('hud-color-dot').style.backgroundColor = asset.color;
            document.getElementById('hud-name').textContent = asset.name.split(' ')[0];
            document.getElementById('hud-name').style.color = 'black';
            document.getElementById('hud-value').textContent = '$' + fmtWan(asset.value);
            document.getElementById('hud-value').style.color = asset.color;

            // 2. Update Stats Panel Color
            updateStats(asset.type);

            // 3. Highlight Card
            // Reset all first
            assets.forEach((_, i) => {
                const el = document.getElementById(`card-${i}`);
                if (el) {
                    el.classList.remove('-translate-y-2', 'ring-2');
                    el.style.borderColor = 'black'; 
                    // Note: resetting ring color involves removing dynamic classes or inline styles. 
                    // For simplicity in vanilla JS with Tailwind, we just reset classes.
                }
            });
            // Highlight current
            const targetCard = document.getElementById(`card-${index}`);
            if (targetCard) {
                targetCard.classList.add('-translate-y-2', 'ring-2');
                targetCard.style.borderColor = asset.color; // Pop color ring
                targetCard.style.boxShadow = `4px 4px 0px 0px ${asset.color}`;
            }

            // 4. Highlight Chart Segment (Manual trigger if hovered via Card)
            if (assetChart.getActiveElements().length === 0 || assetChart.getActiveElements()[0].index !== index) {
                assetChart.setActiveElements([{ datasetIndex: 0, index: index }]);
                assetChart.update();
            }
        }

        function resetAsset() {
            // 1. Reset HUD
            document.getElementById('hud-active').classList.add('hidden');
            document.getElementById('hud-default').classList.remove('hidden');

            // 2. Reset Stats
            updateStats(null);

            // 3. Reset Cards
            assets.forEach((_, i) => {
                const el = document.getElementById(`card-${i}`);
                if (el) {
                    el.classList.remove('-translate-y-2', 'ring-2');
                    el.style.borderColor = 'black';
                }
            });

            // 4. Reset Chart
            assetChart.setActiveElements([]);
            assetChart.update();
        }

        // Initialize Icons
        lucide.createIcons();

    </script>
</body>
</html>
